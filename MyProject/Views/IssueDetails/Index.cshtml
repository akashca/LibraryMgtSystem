@model MyProject.Models.IssueDetails

@{
    ViewData["Title"] = "Index";
}

<h1>Index</h1>

<div>
    <h4>Issue Book</h4>

    <div class="row">
        <div class="col-sm-4">
            @using (Html.BeginForm("Save", "IssueDetails", FormMethod.Post))
            {
                <div class="form-group">
                    <label>IssueId </label>
                    <input type="text" id="IssueId" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>StudentName </label>
                    <input type="text" id="StudentName" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Title </label>
                    <select class="form-control" id="Title" name="Title">
                    <option>Please Select Book</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>IssueDate </label>
                    <input type="date" id="IssueDate" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>ReturnDate </label>
                    <input type="date" id="ReturnDate" class="form-control" required />
                </div>

                <div class="form-group">
                    <input type="submit" value="Save" class="btn btn-dark" required />
                </div>
            }
        </div>
    </div>
</div>
<div>
    @*@Html.ActionLink("Edit", "Edit", new {  id = Model.IssueId }) |*@
    @*<a asp-action="Index">Back to List</a>*@
</div>

@*@Scripts.Render("~/bundles/jquery")*@
@section scripts
{
    <script src="C:\Users\Cloud Analogy\.nuget\packages\bootstrap\5.1.2\contentFiles\any\any\wwwroot\js\bootstrap.js"></script>
    <script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>
    <script src="~/js/site.js"></script>
    <script src="~/lib/jquery/dist/jquery.js"></script>

    <script>
        GetIssueId();
        GetBooks();
        function GetIssueId()
        {
            $("#IssueId").keyup(function(e)
            {
                $.ajax({
                    type: 'POST',
                    url: '/IssueDetails/IssueId?IssueId=' + $("#IssueId").val(),
                    dataType: 'JSON',
                    success: function (data) {
                        $("#Id").val(data);
                    }
                });
            });
        }

        function GetBooks()
        {
                $.ajax(
                    {
                        type: 'GET',
                        url: '/IssueDetails/GetBook',
                        dataType: 'JSON',
                        success: function (data)
                        {
                            console.log(data);
                            for (var i = 0; i < data.length; i++) {
                                $('#Title').append($("<option>").text(data[i].title).val(data[i].id));
                            }

                        }
                    });
        }
        
    
    </script>
}